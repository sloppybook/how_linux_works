# Chapter 3
## 2段階のプロセス生成
Linuxにおける、プロセス生成２つの目的
- 同じプログラムの処理を複数のプロセスに分けて処理する（Webサーバによる複数リクエストの受付）
- まったく別のプログラムを生成する（bashから各種プログラムの新規作成）

これらの目的のため、Linuxには「fork()」「execve()」という関数がある。（「clone()」「execve()」というシステムコールを呼び出す）

### fork()関数
「同じプログラムの処理を複数のプロセスに分けて処理」という目的のために使用。
発行したプロセスをもとに、新たにプロセスを一つ生成する。
生成元を親プロセス、新規に生成されたプロセスを子プロセス。

#### 流れ
1. 子プロセス用メモリ領域を作成して、親プロセスのメモリをコピー。
2. 親プロセスと子プロセスは違うコードを実行するように分岐。これにはfork()関数の戻り値が、親プロセスと子プロセスの間で異なることを利用。

#### 確認
1. fork.cを作成

```
$ cc -o fork fork.c
$ ./fork
I'm parent ! my pid is 2128 and the pid of my child is 2129.
I'm child! my pid is 2129.
```

### execve()関数
まったく別のプログラムを生成する場合に用いられる。

#### 流れ
1. 実行ファイルを読み出して、プロセスのメモリマップに必要な情報を読み出す。
2. 現在のプロセスのメモリを新しいプロセスのデータで上書きする。
3. 新しいプロセスの最初の命令から実行開始。

つまり、まったく別のプログラムを生成する場合は、プロセス数が増えるのではなく、あるプロセスを別のプロセスで置き換える形となる。

